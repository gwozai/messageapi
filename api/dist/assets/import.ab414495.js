import{aB as $,bs as x,d as _,P as N,M as A,o as u,e as g,Z as k,w as i,aD as L,u as E,b as P,al as y,n as v,aj as B,X as j,au as I,K as D,c as T,g as C,f as a,i as F,_ as V}from"./index.2f7faff1.js";import{E as M,a as K}from"./el-table-column.8cf874d2.js";/* empty css                    */import"./el-tag.eb7726f8.js";import{E as U}from"./el-upload.cf89f6f2.js";import"./el-progress.afdd4453.js";import{r as q,u as z}from"./xlsx.db07aefa.js";import"./index.69b52b01.js";import"./event.776e7e11.js";import"./isEqual.894c56f2.js";import"./_Uint8Array.a107ab3a.js";import"./_initCloneObject.3ff6cf23.js";import"./isArrayLikeObject.a5937332.js";import"./cloneDeep.f2afceae.js";import"./_baseClone.bab0c455.js";const R=$({type:{type:String,values:["primary","success","warning","info","danger","default"],default:"default"},underline:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},href:{type:String,default:""},target:{type:String,default:"_self"},icon:{type:x}}),X={click:c=>c instanceof MouseEvent},Z=["href","target"],G=_({name:"ElLink"}),H=_({...G,props:R,emits:X,setup(c,{emit:r}){const l=c,t=N("link"),m=A(()=>[t.b(),t.m(l.type),t.is("disabled",l.disabled),t.is("underline",l.underline&&!l.disabled)]);function b(e){l.disabled||r("click",e)}return(e,n)=>(u(),g("a",{class:v(E(m)),href:e.disabled||!e.href?void 0:e.href,target:e.disabled||!e.href?void 0:e.target,onClick:b},[e.icon?(u(),k(E(P),{key:0},{default:i(()=>[(u(),k(L(e.icon)))]),_:1})):y("v-if",!0),e.$slots.default?(u(),g("span",{key:1,class:v(E(t).e("inner"))},[B(e.$slots,"default")],2)):y("v-if",!0),e.$slots.icon?B(e.$slots,"icon",{key:2}):y("v-if",!0)],10,Z))}});var J=j(H,[["__file","link.vue"]]);const O=I(J);const Q={class:"container"},W={class:"handle-box"},Y=_({name:"import"}),ee=_({...Y,setup(c){const r=D([]);(()=>{r.value=[{id:1,name:"\u5C0F\u660E",sno:"S001",class:"\u4E00\u73ED",age:"10",sex:"\u7537"},{id:2,name:"\u5C0F\u7EA2",sno:"S002",class:"\u4E00\u73ED",age:"9",sex:"\u5973"}]})();const t=D([]),m=async n=>(t.value=await b(n),!0),b=n=>new Promise(function(s,d){const p=new FileReader;p.onload=function(h){const o=h.target.result;let f=q(o,{type:"binary"});const S=f.SheetNames[0],w=z.sheet_to_json(f.Sheets[S]);s(w)},p.readAsBinaryString(n)}),e=async()=>{const n=t.value.map((s,d)=>({id:d,name:s.\u59D3\u540D,sno:s.\u5B66\u53F7,class:s.\u73ED\u7EA7,age:s.\u5E74\u9F84,sex:s.\u6027\u522B}));r.value.push(...n)};return(n,s)=>{const d=T,p=U,h=O,o=M,f=K;return u(),g("div",null,[C("div",Q,[C("div",W,[a(p,{action:"#",limit:1,accept:".xlsx, .xls","show-file-list":!1,"before-upload":m,"http-request":e},{default:i(()=>[a(d,{class:"mr10",type:"success"},{default:i(()=>[F("\u6279\u91CF\u5BFC\u5165")]),_:1})]),_:1}),a(h,{href:"/template.xlsx",target:"_blank"},{default:i(()=>[F("\u4E0B\u8F7D\u6A21\u677F")]),_:1})]),a(f,{data:r.value,border:"",class:"table","header-cell-class-name":"table-header"},{default:i(()=>[a(o,{prop:"id",label:"ID",width:"55",align:"center"}),a(o,{prop:"name",label:"\u59D3\u540D"}),a(o,{prop:"sno",label:"\u5B66\u53F7"}),a(o,{prop:"class",label:"\u73ED\u7EA7"}),a(o,{prop:"age",label:"\u5E74\u9F84"}),a(o,{prop:"sex",label:"\u6027\u522B"})]),_:1},8,["data"])])])}}});const be=V(ee,[["__scopeId","data-v-bcf2fe4a"]]);export{be as default};
